This is for discrete optimization. in first-branch.